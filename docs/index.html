<!-- HTML header for doxygen 1.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" class="dark-mode">
  <head>
    <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=9"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta name="author" content="SXS Collaboration">
    <meta name="generator" content="Doxygen 1.12.0"/>
  <title>fpx.f: fpx.f</title>
  <link href="tabs.css" rel="stylesheet" type="text/css"/>
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript" src="dynsections.js"></script>
  <script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
  <script type="text/javascript" src="doxygen-awesome-fragment-copy-button.js"></script>
  <script type="text/javascript" src="doxygen-awesome-paragraph-link.js"></script>
  <script type="text/javascript" src="doxygen-awesome-interactive-toc.js"></script>
  <script type="text/javascript" src="doxygen-awesome-tabs.js"></script>
  <script type="text/javascript">
      DoxygenAwesomeFragmentCopyButton.init()
      DoxygenAwesomeDarkModeToggle.init()
      DoxygenAwesomeParagraphLink.init()
      DoxygenAwesomeInteractiveToc.init()
      DoxygenAwesomeTabs.init()
  </script>
  <link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
  <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
  <script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/MathJax.js"></script>
  <link href="doxygen.css" rel="stylesheet" type="text/css" />
  <link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<script>
$(function() {
	hljs.configure({useBR: false});
	$(".fragment").each(function(i,node) {
		$(node).removeClass("fragment");
		hljs.highlightBlock(node);
	});
});
</script>
  </head>
  <body>
  <div id="top"><!-- do not remove this div, it is closed by doxygen! -->
  <div id="titlearea">
    <table cellspacing="0" cellpadding="0">
      <tbody>
        <tr style="height: 56px;">
          <td id="projectlogo"><img alt="Logo" src="logo.png" /></td>
          <td id="projectalign" style="padding-left: 0.5em;">
            <div id="projectname">
              <a href="index.html">fpx.f</a>
            </div>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
  <!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('index.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">fpx.f </div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul>
  <li class="level1">
    <a href="#autotoc_md118">Introduction</a>
    <ul>
      <li class="level2">
        <a href="#autotoc_md119">About the Project</a>
      </li>
      <li class="level2">
        <a href="#autotoc_md120">Getting Started</a>
        <ul>
          <li class="level3">
            <a href="#autotoc_md121">Requirements</a>
          </li>
          <li class="level3">
            <a href="#autotoc_md122">Installation</a>
            <ul>
              <li class="level4">
                <a href="#autotoc_md123">Get the code</a>
              </li>
              <li class="level4">
                <a href="#autotoc_md124">Build with fpm</a>
              </li>
              <li class="level4">
                <a href="#autotoc_md125">Build with Visual Studio 2019</a>
              </li>
            </ul>
          </li>
        </ul>
      </li>
      <li class="level2">
        <a href="#autotoc_md126">Usage</a>
        <ul>
          <li class="level3">
            <a href="#autotoc_md127">Command line</a>
          </li>
          <li class="level3">
            <a href="#autotoc_md128">Embedded</a>
          </li>
          <li class="level3">
            <a href="#autotoc_md129">Contributing</a>
          </li>
        </ul>
      </li>
      <li class="level2">
        <a href="#autotoc_md130">License</a>
      </li>
    </ul>
  </li>
</ul>
</div>
<div class="textblock"><p><a class="anchor" id="md__c_1_2_users_2_david_pfister_2_git_hub_2sandbox_2fpx_8f_2_r_e_a_d_m_e"></a> <a class="anchor" id="readme-top"></a></p>
<p><a href="https://github.com/davidpfister/fpx.f/graphs/contributors"><img src="https://img.shields.io/github/contributors/davidpfister/fpx.f.svg?style=for-the-badge" alt="Contributors" style="pointer-events: none;" class="inline"/></a> <a href="https://github.com/davidpfister/fpx.f/network/members"><img src="https://img.shields.io/github/forks/davidpfister/fpx.f.svg?style=for-the-badge" alt="Forks" style="pointer-events: none;" class="inline"/></a> <a href="https://github.com/davidpfister/fpx.f/stargazers"><img src="https://img.shields.io/github/stars/davidpfister/fpx.f.svg?style=for-the-badge" alt="Stargazers" style="pointer-events: none;" class="inline"/></a> <a href="https://github.com/davidpfister/fpx.f/issues"><img src="https://img.shields.io/github/issues/davidpfister/fpx.f.svg?style=for-the-badge" alt="Issues" style="pointer-events: none;" class="inline"/></a> <a href="https://github.com/davidpfister/fpx.f/master/LICENSE"><img src="https://img.shields.io/github/license/davidpfister/fpx.f.svg?style=for-the-badge" alt="MIT License" style="pointer-events: none;" class="inline"/></a></p>
<p><br  />
 </p><div align="center"> <h3 align="center">fpx.f</h3>
</div><div align="center"></div><div align="center"> </div><div align="center"> A Fortran preprocessor in Fortran for modern Fortran. <br  />
 <a href="https://github.com/davidpfister/fpx.f"><b>Explore the project »</b></a> <br  />
 </div><div align="center"> </div><h1><a class="anchor" id="autotoc_md118"></a>
Introduction</h1>
<h2><a class="anchor" id="autotoc_md119"></a>
About the Project</h2>
<p>Fortran, the venerable language of scientific computing, has powered simulations of galaxies, weather systems, and quantum phenomena for over seven decades. Its enduring strength lies in its clarity, performance, and mathematical soul, qualities that resonate deeply with its community of developers. Yet, nestled within this ecosystem is a contentious tool: the preprocessor. From its ad hoc beginnings in the 1970s to its modern incarnations in tools like <code>cpp</code>, <code>fpp</code>, and <code>fypp</code>, preprocessing has been both a lifeline and a lightning rod for Fortran developers.</p>
<p>It enables portability across diverse platforms, conditional compilation for debugging, and code generation for complex libraries. These capabilities are critical to Fortran’s role in high-performance computing. But it also sparks fierce debate, with many Fortraners decrying its tendency to obscure code, disrupt the language’s elegant simplicity, and introduce bugs. <br  />
</p>
<p>This project aims at providing a <em>simple</em>, <em>embeddable</em>, <em>open-source</em> preprocessor written in modern Fortran. <code>fpx</code> is mostly compliant to a C preprocessor, fine-tuned for the specificity of the Fortran language. <code>fpx</code> is an embeddable preprocessor. It can be used as a command-line tool or directly embedded into any solution with the module <code>fpx_parser</code>.</p>
<ul>
<li><a href="https://fpm.fortran-lang.org/"><img src="https://img.shields.io/badge/fpm-000000?style=for-the-badge&amp;logo=Fortran&amp;logoColor=734F96" alt="fpm" class="inline"/></a></li>
<li><a href="https://www.intel.com/content/www/us/en/developer/tools/oneapi/fortran-compiler.html"><img src="https://img.shields.io/badge/ifort-000000?style=for-the-badge&amp;logo=Intel&amp;logoColor=61DAFB" alt="ifort" class="inline"/></a></li>
<li><a href="https://gcc.gnu.org/wiki/GFortran"><img src="https://img.shields.io/badge/gfortran-000000?style=for-the-badge&amp;logo=gnu&amp;logoColor=white" alt="gfortran" class="inline"/></a></li>
</ul>
<p><code>fpx</code> supports:</p><ul>
<li>conditional compilation with <code>#if</code>, <code>#ifdef</code>, <code>#ifndef</code>, <code>#elif</code>, <code>#else</code>,<code>#endif</code></li>
<li>simple macros and function like macros with <code>#define</code>, <code>#undef</code>, <code>defined</code> and <code>!defined</code></li>
<li>simple arithmetic and bitwise operations with <code>+</code>, <code>-</code>, <code>*</code>, <code>**</code>, <code>/</code>, <code>&gt;</code>, <code>&lt;</code>, <code>&gt;=</code>, <code>=&lt;</code>, <code>||</code>, <code>&amp;&amp;</code>, <code>|</code>, <code>^</code>, <code>&amp;</code>, <code>!</code> and <code>~</code>.</li>
<li>include files with <code>#include</code></li>
<li>variadic macros with <code>__VA_ARGS__</code>, and <code>__VA_OPT__</code>,</li>
<li>build-in macros as <code>__LINE__</code>, <code>__FILE__</code>, <code>__FILENAME__</code>, <code>__TIME__</code>, <code>__DATE__</code>, <code>__TIMESTAMP__</code></li>
<li>stringification <code>#</code> and concatenation <code>##</code></li>
<li>and more... <br  />
</li>
</ul>
<h2><a class="anchor" id="autotoc_md120"></a>
Getting Started</h2>
<h3><a class="anchor" id="autotoc_md121"></a>
Requirements</h3>
<p>To build that library you need</p>
<ul>
<li>a Fortran 2008 compliant compiler, or better, a Fortran 2018 compliant compiler (Intel Fortran and gfortran compilers are known to work well for <em>fpx.f</em>).</li>
</ul>
<p>The following compilers are tested on the default branch of <em>fpx.f</em>:</p>
<center></center><center><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadCenter">Name   </th><th class="markdownTableHeadCenter">Version   </th><th class="markdownTableHeadCenter">Platform   </th><th class="markdownTableHeadCenter">Architecture    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">GCC Fortran (MinGW)   </td><td class="markdownTableBodyCenter">14   </td><td class="markdownTableBodyCenter">Windows 10   </td><td class="markdownTableBodyCenter">x86_64    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">Intel oneAPI classic   </td><td class="markdownTableBodyCenter">2021.5   </td><td class="markdownTableBodyCenter">Windows 10   </td><td class="markdownTableBodyCenter">x86_64   </td></tr>
</table>
</center><center></center><ul>
<li>a preprocessor. <em>fpx.f</em> uses some preprocessor macros. It is known to work both with intel <code>fpp</code> and <code>cpp</code>. The goal is for <code>fpx</code> to preproces itself at some point. In particular, the console line application uses the header file <a href="https://github.com/davidpfister/fortiche/tree/master/src/app">'app.inc'</a> from the <a href="https://github.com/davidpfister/fortiche">'fortiche'</a> repo.</li>
</ul>
<p>Unit test rely on the the header file <a href="https://github.com/davidpfister/fortiche/tree/master/src/assertion"><code>assertion.inc</code></a>. Since the whole framework fits in a single file, it has been added directly to the repo.</p>
<p>Linting, indentation, and styling is done with <a href="https://github.com/fortran-lang/fprettify">fprettify</a> with the following settings </p><div class="fragment"><div class="line">fprettify &#39;./src/&#39; -r --case 1 1 1 1 -i 4 --strict-indent --enable-replacements --strip-comments --c-relations</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md122"></a>
Installation</h3>
<h4><a class="anchor" id="autotoc_md123"></a>
Get the code</h4>
<div class="fragment"><div class="line">git clone https://github.com/davidpfister/fpx.f</div>
<div class="line">cd fpx.f</div>
</div><!-- fragment --><h4><a class="anchor" id="autotoc_md124"></a>
Build with fpm</h4>
<p>The repo can be build using <em>fpm</em> </p><div class="fragment"><div class="line">fpm build</div>
</div><!-- fragment --><p> For convenience, the repo also contains a response file that can be invoked as follows: </p><div class="fragment"><div class="line">fpm @build</div>
</div><!-- fragment --><p> (For the Windows users, that command does not work in Powershell since '@' is a reserved symbol. One should use the '&ndash;' as follows: <code>fpm --% @build</code>. This is linked to the following <a href="https://github.com/urbanjost/M_CLI2/issues/19">issue</a>)</p>
<p>Building with ifort requires to specify the compiler name (gfortran by default) </p><div class="fragment"><div class="line">fpm @build --compiler ifort</div>
</div><!-- fragment --><p> Alternatively, the compiler can be set using fpm environment variables. </p><div class="fragment"><div class="line">set FPM_FC=ifort</div>
</div><!-- fragment --><p>Besides the build command, several commands are also available: </p><div class="fragment"><div class="line">@pretiffy</div>
<div class="line">system fprettify .\src\ -r --case 1 1 1 1 -i 4 --strict-indent --enable-replacements --strip-comments --c-relations</div>
<div class="line"> </div>
<div class="line">@clean</div>
<div class="line">option clean --all</div>
<div class="line"> </div>
<div class="line">@rebuild</div>
<div class="line">system rmdir /s /q build</div>
<div class="line">option build</div>
<div class="line"> </div>
<div class="line">@build</div>
<div class="line">option build</div>
<div class="line"> </div>
<div class="line">@test</div>
<div class="line">options test --flag &#39;D_QUIET&#39;</div>
<div class="line"> </div>
<div class="line">@doc</div>
<div class="line">option clean --all</div>
<div class="line">system cd ./.dox &amp; doxygen ./Doxyfile.in &amp; cd ..</div>
</div><!-- fragment --><p>The settings to the cpp preprocessor are specified in the file.</p>
<div class="fragment"><div class="line">[preprocess]</div>
<div class="line">cpp.suffixes = [&quot;F90&quot;, &quot;f90&quot;]</div>
<div class="line">cpp.macros = [&quot;_FPM&quot;]</div>
</div><!-- fragment --><p> The <code>_FPM</code> macro is used to differentiate the build when compiling with <em>fpm</em> or <em>Visual Studio</em>. This is mostly present to adapt the hard coded paths that differs in both cases.</p>
<h4><a class="anchor" id="autotoc_md125"></a>
Build with Visual Studio 2019</h4>
<p>The project was originally developed on Windows with Visual Studio 2019. The repo contains the solution file (<em>Fpx.f.sln</em>) to get you started with Visual Studio 2019.</p>
<h2><a class="anchor" id="autotoc_md126"></a>
Usage</h2>
<h3><a class="anchor" id="autotoc_md127"></a>
Command line</h3>
<p>The preprocessor <code>fpx</code> can be used from the command-line using your favorite shell. The following options are available: </p><center></center><center><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Option   </th><th class="markdownTableHeadLeft">Definition    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">-D&lt;macro&gt;   </td><td class="markdownTableBodyLeft">Define a &lt;macro&gt; with no value.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">-D&lt;macro&gt;=&lt;val&gt;   </td><td class="markdownTableBodyLeft">Define a &lt;macro&gt; with &lt;val&gt; as its value.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">-U&lt;macro&gt;   </td><td class="markdownTableBodyLeft">Undefine &lt;macro&gt;'    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">-I&lt;dir&gt;   </td><td class="markdownTableBodyLeft">Add &lt;dir&gt; to the end of the global include paths.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">-h, -?   </td><td class="markdownTableBodyLeft">Display this help.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">-o   </td><td class="markdownTableBodyLeft">Output file path with name and extension.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">-v   </td><td class="markdownTableBodyLeft">Display the version of the program.   </td></tr>
</table>
</center><center></center><p>Using the file preprocessor could not be easier. The function simply takes as arguments the input and output file paths.</p>
<h3><a class="anchor" id="autotoc_md128"></a>
Embedded</h3>
<div class="fragment"><div class="line"><span class="keyword">program</span> test</div>
<div class="line">    <span class="keywordtype">use </span>fpx_parser</div>
<div class="line">    </div>
<div class="line">    <span class="keyword">call </span><a class="code hl_interface" href="interfacefpx__parser_1_1preprocess.html">preprocess</a>(<span class="stringliteral">&#39;tests/input.in&#39;</span>, <span class="stringliteral">&#39;tests/output.out&#39;</span>)</div>
<div class="line"><span class="keyword">end program</span></div>
<div class="ttc" id="ainterfacefpx__parser_1_1preprocess_html"><div class="ttname"><a href="interfacefpx__parser_1_1preprocess.html">fpx_parser::preprocess</a></div><div class="ttdoc">Generic interface to start preprocessing from various sources/sinks.</div><div class="ttdef"><b>Definition</b> <a href="parser_8f90_source.html#l00078">parser.f90:78</a></div></div>
</div><!-- fragment --><p><em>For more examples, please refer to the <a href="https://davidpfister.github.io/fpx.f/index.html">Documentation</a></em></p>
<h3><a class="anchor" id="autotoc_md129"></a>
Contributing</h3>
<p>Contributions are what make the open source community such an amazing place to learn, inspire, and create. Any contributions you make are <b>greatly appreciated</b>. So, thank you for considering contributing to <em>fpx.f</em>. Please review and follow these <a href="https://github.com/davidpfister/fpx.f/tree/master?tab=contributing-ov-file">guidelines</a> to make the contribution process simple and effective for all involved. In return, the developers will help address your problem, evaluate changes, and guide you through your pull requests.</p>
<p>By contributing to <em>fpx.f</em>, you certify that you own or are allowed to share the content of your contribution under the same license.</p>
<h2><a class="anchor" id="autotoc_md130"></a>
License</h2>
<p>Distributed under the MIT License. </p>
</div></div><!-- PageDoc -->
<a href="doxygen_crawl.html"></a>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">
    &copy; Copyright 2017 - 2024
    <a href="LICENSE.txt" target="_blank">
    <span class="hidden-xs">Distributed under the</span>
    MIT License</a>
  </ul>
</div>
</body>
</html>
